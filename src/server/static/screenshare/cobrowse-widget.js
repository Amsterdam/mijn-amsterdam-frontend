!function(e,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.CobrowseWidget=s():e.CobrowseWidget=s()}(self,(()=>(()=>{"use strict";var e={d:(s,o)=>{for(var t in o)e.o(o,t)&&!e.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:o[t]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},s={};e.r(s),e.d(s,{default:()=>i});const o=JSON.parse('{"en":{"request_share":"Request to share this page","consent_message":"We would like to take a look at this page with you for a short time.","session_ended":"Screen sharing has stopped","help_message":"Call 14 020. Ask our staff member to assist you remotely. Then click â€˜Receive your connection codeâ€™ on this screen. Share the code shown here with our staff member. They will only be able to see the City of Amsterdam screen and will help you continue safely.","stop_sharing":"Stop screen sharing","help_by_sharing":"Help via screen sharing","session_ended_message":"Did you not mean to stop screen sharing? Press the button to get a new connection code. Give this code to the staff member you are speaking to.","close":"Close","allow":"Allow","reject":"Reject","your_code":"Your connection code is:","generate_code":"Receive connection code"},"nl":{"request_share":"Verzoek om deze pagina te delen","consent_message":"Wij willen tijdelijk met u meekijken op deze pagina.","session_ended":"Het schermdelen is gestopt","session_ended_message":"Wilde u het schermdelen niet stoppen? Druk op de knop voor een nieuwe verbindingscode. Geef deze code aan de medewerker, met wie u belt.","help_by_sharing":"Hulp via schermdelen","help_message":"Bel 14 020 en druk op â€˜Ontvang verbindingscodeâ€™. Deze code krijgt u te zien op uw scherm en geeft u aan onze medewerker. Hij ziet alleen wat u laat zien en helpt u veilig verder.","stop_sharing":"Stop schermdelen","close":"Sluiten","allow":"Toestaan","reject":"Afwijzen","your_code":"Uw verbindingscode is:","generate_code":"Ontvang uw verbindingscode"}}'),t=document.currentScript?.dataset?.licenseKey;let n=null;t&&(n=new class{constructor(e,s="nl"){this.licenseKey=e,this.language=s,this.translations=o,(localStorage.getItem("_cobrowse_widget_session")??null)&&this.init(),this.initializeWidget()}async loadCobrowseSDK(){if(window.CobrowseIO)return window.CobrowseIO;try{const e=document.createElement("script");return e.src="https://js.cobrowse.io/CobrowseIO.js",e.async=!0,e.crossOrigin="anonymous",new Promise(((s,o)=>{e.onload=()=>s(window.CobrowseIO),e.onerror=()=>o(new Error("Failed to load Cobrowse SDK")),document.head.appendChild(e)}))}catch(e){console.error("Error loading Cobrowse SDK:",e)}}async init(){const e=await this.loadCobrowseSDK();e.license=this.licenseKey,e.redactedViews=[".cobrowse-redacted"],this.CobrowseIO=e,this.originalTitle=document.title,e.client().then((async()=>{await this.CobrowseIO.start(),this.CobrowseIO.currentSession||localStorage.removeItem("_cobrowse_widget_session"),this.setupSessionControls()})),e.confirmSession=async()=>this.showConsentDialog(this.translations[this.language].request_share,this.translations[this.language].consent_message),e.on("session.updated",(e=>{e.isActive?.()&&localStorage.setItem("_cobrowse_widget_session",JSON.stringify({id:e.id?.(),state:e.state?.()}))})),e.on("session.ended",(()=>{localStorage.removeItem("_cobrowse_widget_session"),this.hideModal(this.sessionCodeContainer),this.sessionCodeContainer,this.removeCobrowseFrame(),this.displaySessionCodeModal("",!0)}))}initializeWidget(){document.getElementById("startCobrowseButton")?.addEventListener("click",(()=>{this.startSession()})),document.addEventListener("keydown",(e=>{e.shiftKey&&"Digit6"===e.code&&this.startSession()}))}setupSessionControls(){this.createSharingBanner(),this.CobrowseIO.showSessionControls=this.showSessionControls.bind(this),this.CobrowseIO.hideSessionControls=this.hideSessionControls.bind(this)}createStopButton(){const e=document.createElement("div");return e.className="__cbio_ignored cobrowse-wrapper stop-cobrowse-button cobrowse-button",e.textContent=this.translations[this.language].stop_sharing,e.addEventListener("click",(()=>{this.CobrowseIO.currentSession&&this.endSession()})),e}createCobrowseFrame(){if(document.getElementById("cobrowse-frame"))return;const e=document.createElement("div");e.id="cobrowse-frame",document.body.appendChild(e)}removeCobrowseFrame(){const e=document.getElementById("cobrowse-frame");e&&e.remove()}showSessionControls(){this.createCobrowseFrame(),document.title="ðŸ”´ "+this.originalTitle,document.body.style.paddingTop="48px",this.sharingBanner.style.display="block"}hideSessionControls(){this.sharingBanner.style.display="none",document.body.style.paddingTop="0",document.title=this.originalTitle,this.removeCobrowseFrame()}createSharingBanner(){this.sharingBanner=document.createElement("div"),this.sharingBanner.className="cobrowse-sharing-banner",this.sharingBanner.style.display="none";const e=this.createStopButton();this.sharingBanner.appendChild(e),document.body.insertBefore(this.sharingBanner,document.body.firstChild)}async startSession(){this.sessionCodeContainer||(this.init(),this.displaySessionCodeModal(""))}displaySessionCodeModal(e,s=null){this.sessionCodeContainer=document.createElement("div"),this.sessionCodeContainer.classList.add("cobrowse-wrapper");const o=s?this.translations[this.language].session_ended:this.translations[this.language].help_by_sharing,t=s?this.translations[this.language].session_ended_message:this.translations[this.language].help_message;e=e.slice(0,3)+"-"+e.slice(3),this.sessionCodeContainer.innerHTML=this.sessionCodeContent(o,t,e,s),this.sessionCodeContainer.querySelector("#closeButton").addEventListener("click",(()=>{this.hideModal(this.sessionCodeContainer),this.sessionCodeContainer=null})),this.sessionCodeContainer.querySelector("#generateButton").addEventListener("click",(async()=>{if(document.getElementById("cobrowse-frame"))console.log("There is an active session already.");else{let e=await this.createSessionCode();e=e.slice(0,3)+"-"+e.slice(3),document.getElementById("sessionCode").innerHTML=e,document.getElementById("codeContainer").style.display="block"}})),document.body.appendChild(this.sessionCodeContainer)}async createSessionCode(){return this.CobrowseIO.createSessionCode()}sessionCodeContent(e,s,o,t=null){const n=!0===t?"blue-button":"secondary-button",i=`\n            <button class="${!0===t?"secondary-button":"blue-button"} cobrowse-button" id="generateButton">${this.translations[this.language].generate_code}</button>\n            <div id="codeContainer">\n                <div class="modal-body">${this.translations[this.language].your_code}</div>\n                <div id="sessionCode">${o}</div>\n            </div>\n            <div>\n                <button id="closeButton" class="${n} cobrowse-button">${this.translations[this.language].close}</button>\n            </div>`;return this.createModal(e,s,i)}showConsentDialog(e,s){this.hideModal(this.sessionCodeContainer),this.sessionCodeContainer=null;const o=document.createElement("div");return o.classList.add("cobrowse-wrapper"),new Promise((t=>{o.innerHTML=this.consentContent(e,s),o.querySelector(".cobrowse-allow").addEventListener("click",(()=>{t(!0),this.hideModal(o)})),o.querySelector(".cobrowse-deny").addEventListener("click",(()=>{t(!1),this.hideModal(o)})),document.body.appendChild(o)}))}consentContent(e,s){const o=`\n        <div>\n            <button class="cobrowse-allow blue-button cobrowse-button">${this.translations[this.language].allow}</button>\n            <button class="cobrowse-deny tertiary-button cobrowse-button" style="padding:10px;">${this.translations[this.language].reject}</button>\n        </div>`;return this.createModal(e,s,o)}createModal(e,s,o){return`\n      <div class="modal-background">\n          <div class="modal-content">\n          <div class="modal-body-container"> \n              <div class="modal-heading"><b>${e}</b></div>\n                  <div class="modal-body">${s}</div>\n                  ${o}\n              </div>\n          </div>\n      </div>`}async endSession(){this.CobrowseIO.currentSession&&await this.CobrowseIO.currentSession.end()}hideModal(e){e?.parentNode&&e.parentNode.removeChild(e)}}(t,"nl"));const i=n;return s})()));