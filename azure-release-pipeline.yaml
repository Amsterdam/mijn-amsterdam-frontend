trigger:
  tags:
    include:
      - release-v*
pr: none

resources:
  repositories:
    - repository: MamsInfra
      type: git
      name: MijnAmsterdam/mijn-amsterdam-infra
      ref: refs/heads/main

jobs:
  - ${{ if eq(variables['Build.SourceBranchName'], 'main') }}:
      - template: pipelines/jobs/apps/btd-frontend.yaml@MamsInfra
        parameters:
          dtapName: p
          btdBuild: true
          btdTest: true
          btdDeploy: true
          btdAppBFF: true
          btdAppUI: true
  - ${{ if ne(variables['Build.SourceBranchName'], 'main') }}:
      - job: EchoMessage
        displayName: 'Warning: Pipeline triggered a release on the wrong branch'
        steps:
          - script: echo "This pipeline is only triggered for the main branch. Instead $(variables['Build.SourceBranchName'])"
            displayName: 'Print message'
